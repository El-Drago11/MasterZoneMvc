<script>
    $(document).ready(function () {
        $.get("/Business/GetBusinessAdminToken", null, function (dataToken) {
            if (dataToken != "" && dataToken != null) {
                UserToken_Global = dataToken;
                ViewDocuments();
            }
            else {
                $.get("/Business/GetStaffToken", null, function (dataToken) {
                    if (dataToken != "" && dataToken != null) {
                        UserToken_Global = dataToken;
                        //StopLoading();
                    }
                    else {
                        StopLoading();
                    }
                });
            }
        });
    });
 function ViewDocuments() {

    var _url = "/api/Business/Profile/UploadedDocumets/";

    StartLoading();

    $.ajax({
        type: "GET",
        url: _url,
        headers: {
            "Authorization": "Bearer " + UserToken_Global,
            "Content-Type": "application/json"
        },
        contentType: 'application/json',
        success: function (response) {
            if (response.status < 1) {
                $.iaoAlert({
                    msg: response.message,
                    type: "error",
                    mode: "dark",
                });
                return;
            }
           var htmlData = '';
             if (response.data.length <= 0) 
             {
                
                htmlData = `<div class="w-100 text-center font-italic"><span class="w-auto py-2 px-5 bg-primary text-white rounded">@(Resources.BusinessPanel.NoDocumetsUploadedErrorMessage)</span></div>`;
               $("#BindBusinessOwnerUploadedDocuments").append(htmlData);
             
             }
            else{

            for(var i= 0 ; i < response.data.length; i++)
            {
                var btn_class = response.data[i].Status == 0 ? "text-warning" : (response.data[i].Status == 1 ? "text-success" : "text-danger");
                htmlData = `<div class="col-sm-3 p-3 mb-5 mr-3 border-radius" style="border: 1px solid #e3e2e2">
                                        Status:<span class= " ${btn_class}">  ${response.data[i].IsAcception}</span>
                                        <label>Document Title : ${response.data[i].DocumentTitle}</label>
                                        <img src="${response.data[i].UploadedDocumentsWithPath}" class="documentImage"><br>
                                    <div class="text-center">    
                                        <form action="/Business/Download" method="POST">
                                        <a href="${response.data[i].UploadedDocumentsWithPath}" target="_blank" class="btn btn-info text-light mt-3">View</a>

                                        <input type="hidden" name="ExportData" value="${response.data[i].DocumentFile}" />
                                        <input type="submit" class="btn btn-success mt-3 ml-2" style="width: 98px;" value="Download" />
                                       </form>
                                   </div>
                               </div>`;


                $("#BindBusinessOwnerUploadedDocuments").append(htmlData);
            }

             }


            StopLoading();
        },
        error: function (result) {
            StopLoading();

            if (result["status"] == 401) {
                $.iaoAlert({
                    msg: '@(Resources.ErrorMessage.UnAuthorizedErrorMessage)',
                    type: "error",
                    mode: "dark",
                });
            }
            else {
                $.iaoAlert({
                    msg: '@(Resources.ErrorMessage.TechincalErrorMessage)',
                    type: "error",
                    mode: "dark",
                });
            }
        }
    });
    }
</script>
