
<script>
    var UserToken_Global = "";
    var DanceId_Global = 0;
    var BannerImageType = 1;
    var AboutImageType = 1;
    var ReviewImageType = 1;
    var PackageId_Global = 0;

    $(document).ready(function () {
        $.get("/Business/GetBusinessAdminToken", null, function (dataToken) {
            if (dataToken != "" && dataToken != null) {

                UserToken_Global = dataToken;
                EditBusinessContentBanner();
                EditBusinessContentAbout();
                EditBusinessContentEventReview();
                EditBusinessContentDanceProfessional();
                EditBusinessContentPackage();
                EditBusinessContentContactInformation();
                StopLoading();
            }
            else {
                $.get("/Business/GetStaffToken", null, function (dataToken) {
                    if (dataToken != "" && dataToken != null) {
                        UserToken_Global = dataToken;
                        EditBusinessContentBanner();
                        EditBusinessContentAbout();
                        EditBusinessContentEventReview();
                        EditBusinessContentDanceProfessional();
                        EditBusinessContentPackage();
                        EditBusinessContentContactInformation();
                        //StopLoading();
                    }
                    else {
                        StopLoading();
                    }
                });
            }
        });
    });

     // To Add/Update Contact Information Detail

      var ContactInformationIdGlobal = 0;
    function btnSubmitContactInformationSection() {
        
        let is_valid = true;
        $(".error-class").html('');
        var _mode = 1;

        let _manageTitle = $("#txtContactInfoTitle").val().trim();
        let _manageDescription = $("#ContactInfo_description").val().trim();

        let _error_manageTitle = $("#error_txtContactInfoTitle");
        let _error_manageDescription = $("#error_ContactInfo_description");

         if (validate_IsEmptyStringInputFieldValue(_manageTitle)) {
            is_valid = false;
             _error_manageTitle.html('@(Resources.BusinessPanel.TitleRequired)');
         }
        if (validate_IsEmptyStringInputFieldValue(_manageDescription)) {
            is_valid = false;
            _error_manageDescription.html('@(Resources.BusinessPanel.DescriptionRequired)');
        }


        if (is_valid) {

            var data = new FormData();

            data.append("Id", ContactInformationIdGlobal);
            data.append("Title", _manageTitle);
            data.append("Description", _manageDescription);
            data.append('Mode', _mode);

            $.ajax({
                url: '/api/Business/AddUpdateContactInformationDetail_PPCMeta',
                headers: {
                    "Authorization": "Bearer " + UserToken_Global
                },
                data: data,
                processData: false,
                mimeType: 'multipart/form-data',
                contentType: false,
                //contentType: 'application/json',
                type: 'POST',
                success: function (dataResponse) {

                    //--Parse into Json of response-json-string
                    dataResponse = JSON.parse(dataResponse);


                    //--If successfully added/updated
                    if (dataResponse.status === 1) {
                        swal("Success!", dataResponse.message, "success");
                       // GetAllAdvertisementsForBusinessPagination();
                    }
                    else {
                        swal({
                            title: 'Error!',
                            icon: 'error',
                            text: dataResponse.message
                        });
                        StopLoading();

                        return;
                    }

                   // EditBusinessProfile();
                    StopLoading();

                },
                error: function (result) {
                    StopLoading();

                    if (result["status"] == 401) {
                        $.iaoAlert({
                            msg: '@(Resources.ErrorMessage.UnAuthorizedErrorMessage)',
                            type: "error",
                            mode: "dark",
                        });
                    }
                    else {
                        $.iaoAlert({
                            msg: '@(Resources.ErrorMessage.TechincalErrorMessage)',
                            type: "error",
                            mode: "dark",
                        });
                    }
                }
            });
        }

    }

    function EditBusinessContentContactInformation() {
        
        var _url = "/api/Business/GetBusinessContentContactInformationDetail_PPCMeta" ;

    StartLoading();

    $.ajax({
        type: "GET",
        url: _url,
        headers: {
            "Authorization": "Bearer " + UserToken_Global,
            "Content-Type": "application/json"
        },
        contentType: 'application/json',
        success: function (response) {
            if (response.status < 1) {
                $.iaoAlert({
                    msg: response.message,
                    type: "error",
                    mode: "dark",
                });
                return;
            }
            ContactInformationIdGlobal = response.data.Id;
            $("#txtContactInfoTitle").val(response.data.Title);
            $("#ContactInfo_description").val(response.data.Description);

            StopLoading();
        },
        error: function (result) {
            StopLoading();

            if (result["status"] == 401) {
                $.iaoAlert({
                    msg: '@(Resources.ErrorMessage.UnAuthorizedErrorMessage)',
                    type: "error",
                    mode: "dark",
                });
            }
            else {
                $.iaoAlert({
                    msg: '@(Resources.ErrorMessage.TechincalErrorMessage)',
                    type: "error",
                    mode: "dark",
                });
            }
        }
    });
    }


     //////////////////////////////////////////////////////////To Add Professional///////////////////////////////////
    var ProfessionalId_Global = 0;

    function btnSubmitDanceProfessionalClick() {

        let is_valid = true;
        $(".error-class").html('');
         var _mode = 1;

        let _manageTitle = $("#Professionaltitle").val().trim();
        let _managedescription = $("#Professionaldescription").val().trim();

        if (is_valid) {

            var data = new FormData();

            data.append("Id", ProfessionalId_Global);
            data.append("ProfessionalTitle", _manageTitle);
            data.append("Description", _managedescription);
            data.append('Mode', _mode);


            $.ajax({
                url: '/api/Business/AddUpdateBusinessProfessional',
                headers: {
                    "Authorization": "Bearer " + UserToken_Global
                },
                data: data,
                processData: false,
                mimeType: 'multipart/form-data',
                contentType: false,
                //contentType: 'application/json',
                type: 'POST',
                success: function (dataResponse) {

                    //--Parse into Json of response-json-string
                    dataResponse = JSON.parse(dataResponse);


                    //--If successfully added/updated
                    if (dataResponse.status === 1) {
                        swal("Success!", dataResponse.message, "success");
                        //GetAllBusinessContentBannerPagination();
                    }
                    else {
                        swal({
                            title: 'Error!',
                            icon: 'error',
                            text: dataResponse.message
                        });
                        StopLoading();

                        return;
                    }

                   // EditBusinessProfile();
                    StopLoading();

                },
                error: function (result) {
                    StopLoading();

                    if (result["status"] == 401) {
                        $.iaoAlert({
                            msg: '@(Resources.ErrorMessage.UnAuthorizedErrorMessage)',
                            type: "error",
                            mode: "dark",
                        });
                    }
                    else {
                        $.iaoAlert({
                            msg: '@(Resources.ErrorMessage.TechincalErrorMessage)',
                            type: "error",
                            mode: "dark",
                        });
                    }
                }
            });
        }

    }

    function EditBusinessContentDanceProfessional() {


        var _url = "/api/Business/ProfessionalDetail/Get/";

    StartLoading();

    $.ajax({
        type: "GET",
        url: _url,
        headers: {
            "Authorization": "Bearer " + UserToken_Global,
            "Content-Type": "application/json"
        },
        contentType: 'application/json',
        success: function (response) {
            if (response.status < 1) {
                $.iaoAlert({
                    msg: response.message,
                    type: "error",
                    mode: "dark",
                });
                return;
            }
            ProfessionalId_Global = response.data.Id;
            $("#Professionaltitle").val(response.data.ProfessionalTitle);
            $("#Professionaldescription").val(response.data.Description);



            StopLoading();
        },
        error: function (result) {
            StopLoading();

            if (result["status"] == 401) {
                $.iaoAlert({
                    msg: '@(Resources.ErrorMessage.UnAuthorizedErrorMessage)',
                    type: "error",
                    mode: "dark",
                });
                //GetAllBusinessContentTennisPagination();
            }
            else {
                $.iaoAlert({
                    msg: '@(Resources.ErrorMessage.TechincalErrorMessage)',
                    type: "error",
                    mode: "dark",
                });
            }
        }
    });
    }


//////////////////////////////////////// To Add Package Detail ///////////////////

    function btnSubmitBusinessContentPackageClick() {

        let is_valid = true;
        $(".error-class").html('');
        var _mode = 1;

        let _manageTitle = $("#txtPackageTitle").val().trim();
        let _manageDescription = $("#txt_Packagedescription").val().trim();

        let _error_manageTitle = $("#error_txtPackageTitle");
        let _error_manageDescription = $("#error_txt_description");

         if (validate_IsEmptyStringInputFieldValue(_manageTitle)) {
            is_valid = false;
             _error_manageTitle.html('@(Resources.BusinessPanel.TitleRequired)');
         }
        if (validate_IsEmptyStringInputFieldValue(_manageDescription)) {
            is_valid = false;
            _error_manageDescription.html('@(Resources.BusinessPanel.DescriptionRequired)');
        }


        if (is_valid) {

            var data = new FormData();

            data.append("Id", PackageId_Global);
            data.append("BusinessPlanTitle", _manageTitle);
            data.append("BusinessPlanDescription", _manageDescription);
            data.append('Mode', _mode);

            $.ajax({
                url: '/api/BusinessPlan/AddUpdateBusinessPlanPCCMeta_Detail',
                headers: {
                    "Authorization": "Bearer " + UserToken_Global
                },
                data: data,
                processData: false,
                mimeType: 'multipart/form-data',
                contentType: false,
                //contentType: 'application/json',
                type: 'POST',
                success: function (dataResponse) {

                    //--Parse into Json of response-json-string
                    dataResponse = JSON.parse(dataResponse);


                    //--If successfully added/updated
                    if (dataResponse.status === 1) {
                        swal("Success!", dataResponse.message, "success");
                       // GetAllAdvertisementsForBusinessPagination();
                    }
                    else {
                        swal({
                            title: 'Error!',
                            icon: 'error',
                            text: dataResponse.message
                        });
                        StopLoading();

                        return;
                    }
                    ResetPackageView();
                   // EditBusinessProfile();
                    StopLoading();

                },
                error: function (result) {
                    StopLoading();

                    if (result["status"] == 401) {
                        $.iaoAlert({
                            msg: '@(Resources.ErrorMessage.UnAuthorizedErrorMessage)',
                            type: "error",
                            mode: "dark",
                        });
                    }
                    else {
                        $.iaoAlert({
                            msg: '@(Resources.ErrorMessage.TechincalErrorMessage)',
                            type: "error",
                            mode: "dark",
                        });
                    }
                }
            });
        }

    }

    function EditBusinessContentPackage() {

        var _url = "/api/BusinessPlan/GetBusinessPlanDetail" ;

    StartLoading();

    $.ajax({
        type: "GET",
        url: _url,
        headers: {
            "Authorization": "Bearer " + UserToken_Global,
            "Content-Type": "application/json"
        },
        contentType: 'application/json',
        success: function (response) {
            if (response.status < 1) {
                $.iaoAlert({
                    msg: response.message,
                    type: "error",
                    mode: "dark",
                });
                return;
            }
            PackageId_Global = response.data.Id;
            $("#txtPackageTitle").val(response.data.BusinessPlanTitle);
            $("#txt_Packagedescription").val(response.data.BusinessPlanDescription);

            StopLoading();
        },
        error: function (result) {
            StopLoading();

            if (result["status"] == 401) {
                $.iaoAlert({
                    msg: '@(Resources.ErrorMessage.UnAuthorizedErrorMessage)',
                    type: "error",
                    mode: "dark",
                });
            }
            else {
                $.iaoAlert({
                    msg: '@(Resources.ErrorMessage.TechincalErrorMessage)',
                    type: "error",
                    mode: "dark",
                });
            }
        }
    });
    }




    function ResetAddView() {
        $("#txtTitle").val('');
        $("#txtSubTitle").val('');
        $("#txtButtonText").val('');
        $("#txtButtonLink").val('');
        $(".error-class").html('');
        $("#fileProfileImage_ManageDanceBannerImage").val('');
        $("#previewImage").attr('src', '');
        $("#previewImage").addClass('d-none');
    }

    function btnSubmitDanceBannerClick() {

        let is_valid = true;
        $(".error-class").html('');
        var _mode =  1;

         let _manageTitle = $("#txtTitle").val().trim();
         let _manageSubTitle = $("#txtSubTitle").val().trim();
         let _manageButtontext = $("#txtButtonText").val().trim();
         let _manageButtonLink = $("#txtButtonLink").val().trim();


         let _error_manageTitle = $("#error_txtTitle");
         let _error_manageSubTitle = $("#error_txtSubTitle");
         let _error_manageButtontext = $("#error_txtButtonText");
        let _error_manageButtonLink = $("#error_txtButtonLink");
        let _error_managedanceImage = $("#error_fileProfileImage_ManageDanceBannerImage");

         if (validate_IsEmptyStringInputFieldValue(_manageTitle)) {
            is_valid = false;
             _error_manageTitle.html('@(Resources.BusinessPanel.TitleRequired)');
         }
         if (validate_IsEmptyStringInputFieldValue(_manageSubTitle)) {
            is_valid = false;
             _error_manageSubTitle.html('@(Resources.BusinessPanel.SubTitleRequired)');
        }
         if (validate_IsEmptyStringInputFieldValue(_manageButtontext)) {
            is_valid = false;
             _error_manageButtontext.html('@(Resources.BusinessPanel.ButtonTextRequired)');
         }
         if (validate_IsEmptyStringInputFieldValue(_manageButtonLink)) {
            is_valid = false;
             _error_manageButtonLink.html('@(Resources.BusinessPanel.ButtonLinkRequired)');
        }
        var _danceImageFile_MS = $("#fileProfileImage_ManageDanceBannerImage").get(0);
        var _danceImageFiles = _danceImageFile_MS.files;
        if ( BannerImageType == 1 && _danceImageFiles.length <= 0) {
            _error_managedanceImage.html('@(Resources.BusinessPanel.BusinessBannerImageRequired)');
            return;
        }

        if (is_valid) {

            var data = new FormData();

            data.append("Id", DanceId_Global);
            data.append("Title", _manageTitle);
            data.append("SubTitle", _manageSubTitle);
            data.append("ButtonText", _manageButtontext);
            data.append("ButtonLink", _manageButtonLink);
            data.append('Mode', _mode);


            data.append('BannerImage', _danceImageFiles[0]);



            $.ajax({
                url: '/api/Business/AddUpdateBusinessBanner',
                headers: {
                    "Authorization": "Bearer " + UserToken_Global
                },
                data: data,
                processData: false,
                mimeType: 'multipart/form-data',
                contentType: false,
                //contentType: 'application/json',
                type: 'POST',
                success: function (dataResponse) {

                    //--Parse into Json of response-json-string
                    dataResponse = JSON.parse(dataResponse);


                    //--If successfully added/updated
                    if (dataResponse.status === 1) {
                        swal("Success!", dataResponse.message, "success");
                       // GetAllAdvertisementsForBusinessPagination();
                    }
                    else {
                        swal({
                            title: 'Error!',
                            icon: 'error',
                            text: dataResponse.message
                        });
                        StopLoading();

                        return;
                    }

                   // EditBusinessProfile();
                    StopLoading();

                },
                error: function (result) {
                    StopLoading();

                    if (result["status"] == 401) {
                        $.iaoAlert({
                            msg: '@(Resources.ErrorMessage.UnAuthorizedErrorMessage)',
                            type: "error",
                            mode: "dark",
                        });
                    }
                    else {
                        $.iaoAlert({
                            msg: '@(Resources.ErrorMessage.TechincalErrorMessage)',
                            type: "error",
                            mode: "dark",
                        });
                    }
                }
            });
        }

    }

    function EditBusinessContentBanner() {

    var _url = "/api/Business/BannerDetail/Get/" ;

    StartLoading();

    $.ajax({
        type: "GET",
        url: _url,
        headers: {
            "Authorization": "Bearer " + UserToken_Global,
            "Content-Type": "application/json"
        },
        contentType: 'application/json',
        success: function (response) {
            if (response.status < 1) {
                $.iaoAlert({
                    msg: response.message,
                    type: "error",
                    mode: "dark",
                });
                return;
            }
         DanceId_Global = response.data.Id;
        $("#txtTitle").val(response.data.Title);
        $("#txtSubTitle").val(response.data.SubTitle);
        $("#txtButtonText").val(response.data.ButtonText);
        $("#txtButtonLink").val(response.data.ButtonLink);
        $("#fileProfileImage_ManageDanceBannerImage").val('');
        if (response.data.BannerImageWithPath != "") {
        $("#previewImage").attr('src', response.data.BannerImageWithPath);
            $("#previewImage").removeClass('d-none');
            BannerImageType = 2;
        }



            StopLoading();
        },
        error: function (result) {
            StopLoading();

            if (result["status"] == 401) {
                $.iaoAlert({
                    msg: '@(Resources.ErrorMessage.UnAuthorizedErrorMessage)',
                    type: "error",
                    mode: "dark",
                });
            }
            else {
                $.iaoAlert({
                    msg: '@(Resources.ErrorMessage.TechincalErrorMessage)',
                    type: "error",
                    mode: "dark",
                });
            }
        }
    });
    }

    ////// -----------    FIELD VALIDATION HANDLER FUNCTIONS  --------------------------

    const validate_IsEmptyStringInputFieldValue = function (inputFieldValue) {
        if (inputFieldValue == '' || inputFieldValue.replace(/\s/g, "") == "")
            return true;
        return false;
    }

    const validate_IsEmptySelectInputFieldValue = function (inputFieldValue) {
        if (inputFieldValue == undefined || inputFieldValue == null || inputFieldValue == '' || inputFieldValue == 0)
            return true;
        return false;
    }
    ////// -----------    FIELD VALIDATION HANDLER FUNCTIONS  --------------------------
    // Image File Preview -------------------------------------------------------------
    document.getElementById('fileProfileImage_ManageDanceBannerImage').addEventListener('change', handleImageUpload);

function handleImageUpload(event) {
    const file = event.target.files[0];
    const fileSize = file.size / 1024; // size in kilobytes
    const maxSize = 10*1024*1024; // maximum size in kilobytes
    const fileType = file.type;
    const validImageTypes = ['image/jpeg', 'image/png'];

    if (!validImageTypes.includes(fileType)) {
        $.iaoAlert({
            msg: '@(Resources.BusinessPanel.ValidImageTypesRequired)',
            type: "error",
            mode: "dark",
        });
        event.target.value = null; // clear the file input element
        $('#previewImage').addClass('d-none'); // hide the preview image
        return;
    }
    if (fileSize > maxSize) {
        $.iaoAlert({
            msg: '@(String.Format(Resources.BusinessPanel.FileSizeRequired, "10 MB"))',
            type: "error",
            mode: "dark",
        });
        event.target.value = null; // clear the file input element
        $('#previewImage').addClass('d-none'); // hide the preview image

        return;
    }

    // image size is within the limit, display the preview image
    const reader = new FileReader();
    reader.onload = function (event) {
        document.getElementById('previewImage').src = event.target.result;
        $('#previewImage').removeClass('d-none');
    }

    reader.readAsDataURL(file);
    }

    ///About Section

    var DanceAboutId_Global = 0;
    function btnSubmitBusinessContentAboutClick() {

        let is_valid = true;
        $(".error-class").html('');
        var _mode =  1;

        let _manageAboutTitle = $("#txtAboutTitle").val().trim();


        let _error_manageAboutTitle = $("#error_txtAboutTitle");
        let _error_manageAboutImage = $("#error_fileProfileImage_ManageDanceAboutImage");

        if (validate_IsEmptyStringInputFieldValue(_manageAboutTitle)) {
            is_valid = false;
            _error_manageAboutTitle.html('@(Resources.BusinessPanel.TitleRequired)');
         }
        var _aboutImageFile_MS = $("#fileProfileImage_ManageDanceAboutImage").get(0);
        var _aboutImageFiles = _aboutImageFile_MS.files;
        if ( AboutImageType ==1 && _aboutImageFiles.length <= 0) {
            _error_manageAboutImage.html('@(Resources.BusinessPanel.BusinessAboutImageRequired)');
            return;
        }


        if (is_valid) {

            var data = new FormData();

            data.append("Id", DanceAboutId_Global);
            data.append("Title", _manageAboutTitle);
            data.append('Mode', _mode);


            data.append('AboutImage', _aboutImageFiles[0]);



            $.ajax({
                url: '/api/Business/AddUpdateBusinessAbout',
                headers: {
                    "Authorization": "Bearer " + UserToken_Global
                },
                data: data,
                processData: false,
                mimeType: 'multipart/form-data',
                contentType: false,
                //contentType: 'application/json',
                type: 'POST',
                success: function (dataResponse) {

                    //--Parse into Json of response-json-string
                    dataResponse = JSON.parse(dataResponse);


                    //--If successfully added/updated
                    if (dataResponse.status === 1) {
                        swal("Success!", dataResponse.message, "success");
                       // GetAllAdvertisementsForBusinessPagination();
                    }
                    else {
                        swal({
                            title: 'Error!',
                            icon: 'error',
                            text: dataResponse.message
                        });
                        StopLoading();

                        return;
                    }

                   // EditBusinessProfile();
                    StopLoading();

                },
                error: function (result) {
                    StopLoading();

                    if (result["status"] == 401) {
                        $.iaoAlert({
                            msg: '@(Resources.ErrorMessage.UnAuthorizedErrorMessage)',
                            type: "error",
                            mode: "dark",
                        });
                    }
                    else {
                        $.iaoAlert({
                            msg: '@(Resources.ErrorMessage.TechincalErrorMessage)',
                            type: "error",
                            mode: "dark",
                        });
                    }
                }
            });
        }

    }

    function EditBusinessContentAbout() {

        var _url = "/api/Business/GetBusinessContentAbout" ;

    StartLoading();

    $.ajax({
        type: "GET",
        url: _url,
        headers: {
            "Authorization": "Bearer " + UserToken_Global,
            "Content-Type": "application/json"
        },
        contentType: 'application/json',
        success: function (response) {
            if (response.status < 1) {
                $.iaoAlert({
                    msg: response.message,
                    type: "error",
                    mode: "dark",
                });
                return;
            }
            DanceAboutId_Global = response.data.Id;
            $("#txtAboutTitle").val(response.data.Title);
            $("#fileProfileImage_ManageDanceAboutImage").val('');
        if (response.data.AboutImageWithPath != "") {
            $("#previewAboutImage").attr('src', response.data.AboutImageWithPath);
            $("#previewAboutImage").removeClass('d-none');
            AboutImageType = 2;
        }



            StopLoading();
        },
        error: function (result) {
            StopLoading();

            if (result["status"] == 401) {
                $.iaoAlert({
                    msg: '@(Resources.ErrorMessage.UnAuthorizedErrorMessage)',
                    type: "error",
                    mode: "dark",
                });
            }
            else {
                $.iaoAlert({
                    msg: '@(Resources.ErrorMessage.TechincalErrorMessage)',
                    type: "error",
                    mode: "dark",
                });
            }
        }
    });
    }

      // Image File Preview -------------------------------------------------------------
    document.getElementById('fileProfileImage_ManageDanceAboutImage').addEventListener('change', handleAboutImageUpload);

    function handleAboutImageUpload(event) {
    const file = event.target.files[0];
    const fileSize = file.size / 1024; // size in kilobytes
    const maxSize = 10*1024*1024; // maximum size in kilobytes
    const fileType = file.type;
    const validImageTypes = ['image/jpeg', 'image/png'];

    if (!validImageTypes.includes(fileType)) {
        $.iaoAlert({
            msg: '@(Resources.BusinessPanel.ValidImageTypesRequired)',
            type: "error",
            mode: "dark",
        });
        event.target.value = null; // clear the file input element
        $('#previewAboutImage').addClass('d-none'); // hide the preview image
        return;
    }
    if (fileSize > maxSize) {
        $.iaoAlert({
            msg: '@(String.Format(Resources.BusinessPanel.FileSizeRequired, "10 MB"))',
            type: "error",
            mode: "dark",
        });
        event.target.value = null; // clear the file input element
        $('#previewAboutImage').addClass('d-none'); // hide the preview image

        return;
    }

    // image size is within the limit, display the preview image
    const reader = new FileReader();
    reader.onload = function (event) {
        document.getElementById('previewAboutImage').src = event.target.result;
        $('#previewAboutImage').removeClass('d-none');
    }

    reader.readAsDataURL(file);
}

      //////////////////////////////////////////////////////////////////////To Review Detail/////////////////////////////
    var ReviewId_Global = 0;

    function btnSubmitEventOrganisationReviewClick() {

        let is_valid = true;
        $(".error-class").html('');
         var _mode = 1;


        let _managedescription = $("#description").val().trim();


        let _error_manageeventReviewImage = $("#error_fileProfileImage_ManageEventReviewImage");
        var _eventreviewImageFile_MS = $("#fileProfileImage_ManageEventReviewImage").get(0);
        var _eventreviewImageFiles = _eventreviewImageFile_MS.files;

        if ( ReviewImageType == 1 && _eventreviewImageFiles.length <= 0) {
            is_valid = false;
            _error_manageeventReviewImage.html('@(Resources.BusinessPanel.BusinessReviewImageRequired)');
            return;
        }

        if (is_valid) {

            var data = new FormData();

            data.append("Id", ReviewId_Global);
            data.append("Description", _managedescription);
            data.append('Mode', _mode);


            data.append('ReviewImage', _eventreviewImageFiles[0]);



            $.ajax({
                url: '/api/Business/AddUpdateBusinessReview',
                headers: {
                    "Authorization": "Bearer " + UserToken_Global
                },
                data: data,
                processData: false,
                mimeType: 'multipart/form-data',
                contentType: false,
                //contentType: 'application/json',
                type: 'POST',
                success: function (dataResponse) {

                    //--Parse into Json of response-json-string
                    dataResponse = JSON.parse(dataResponse);


                    //--If successfully added/updated
                    if (dataResponse.status === 1) {
                        swal("Success!", dataResponse.message, "success");
                        //GetAllBusinessContentBannerPagination();
                    }
                    else {
                        swal({
                            title: 'Error!',
                            icon: 'error',
                            text: dataResponse.message
                        });
                        StopLoading();

                        return;
                    }

                   // EditBusinessProfile();
                    StopLoading();

                },
                error: function (result) {
                    StopLoading();

                    if (result["status"] == 401) {
                        $.iaoAlert({
                            msg: '@(Resources.ErrorMessage.UnAuthorizedErrorMessage)',
                            type: "error",
                            mode: "dark",
                        });
                    }
                    else {
                        $.iaoAlert({
                            msg: '@(Resources.ErrorMessage.TechincalErrorMessage)',
                            type: "error",
                            mode: "dark",
                        });
                    }
                }
            });
        }

    }

    function EditBusinessContentEventReview() {


        var _url = "/api/Business/ReviewDetail/Get";

    StartLoading();

    $.ajax({
        type: "GET",
        url: _url,
        headers: {
            "Authorization": "Bearer " + UserToken_Global,
            "Content-Type": "application/json"
        },
        contentType: 'application/json',
        success: function (response) {
            if (response.status < 1) {
                $.iaoAlert({
                    msg: response.message,
                    type: "error",
                    mode: "dark",
                });
                return;
            }
            ReviewId_Global = response.data.BusinessReviewDetail.Id;
            $("#description").val(response.data.BusinessReviewDetail.Description);
            $("#fileProfileImage_ManageEventReviewImage").val('');
            if (response.data.BusinessReviewDetail.ReviewImageWithPath != "") {
                $("#previewReviewImage").attr('src', response.data.BusinessReviewDetail.ReviewImageWithPath);
                $("#previewReviewImage").removeClass('d-none');
                ReviewImageType = 2;
        }



            StopLoading();
        },
        error: function (result) {
            StopLoading();

            if (result["status"] == 401) {
                $.iaoAlert({
                    msg: '@(Resources.ErrorMessage.UnAuthorizedErrorMessage)',
                    type: "error",
                    mode: "dark",
                });
                //GetAllBusinessContentTennisPagination();
            }
            else {
                $.iaoAlert({
                    msg: '@(Resources.ErrorMessage.TechincalErrorMessage)',
                    type: "error",
                    mode: "dark",
                });
            }
        }
    });
    }


      ////// -----------    FIELD VALIDATION HANDLER FUNCTIONS  --------------------------

    document.getElementById('fileProfileImage_ManageEventReviewImage').addEventListener('change', handleReviewImageUpload);

    function handleReviewImageUpload(event) {
    const file = event.target.files[0];
    const fileSize = file.size / 1024; // size in kilobytes
    const maxSize = 10*1024*1024; // maximum size in kilobytes
    const fileType = file.type;
    const validImageTypes = ['image/jpeg', 'image/png'];

    if (!validImageTypes.includes(fileType)) {
        $.iaoAlert({
            msg: '@(Resources.BusinessPanel.ValidImageTypesRequired)',
            type: "error",
            mode: "dark",
        });
        event.target.value = null; // clear the file input element
        $('#previewReviewImage').addClass('d-none'); // hide the preview image
        return;
    }
    if (fileSize > maxSize) {
        $.iaoAlert({
            msg: '@(String.Format(Resources.BusinessPanel.FileSizeRequired, "10 MB"))',
            type: "error",
            mode: "dark",
        });
        event.target.value = null; // clear the file input element
        $('#previewReviewImage').addClass('d-none'); // hide the preview image

        return;
    }

    // image size is within the limit, display the preview image
    const reader = new FileReader();
    reader.onload = function (event) {
        document.getElementById('previewReviewImage').src = event.target.result;
        $('#previewReviewImage').removeClass('d-none');
    }

    reader.readAsDataURL(file);
    }



</script>